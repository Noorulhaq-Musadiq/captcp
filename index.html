<!doctype html>

<!--[if lt IE 7 ]> <html class="ie ie6 no-js" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie ie7 no-js" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie ie8 no-js" lang="en"> <![endif]-->
<!--[if IE 9 ]>    <html class="ie ie9 no-js" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!-- the "no-js" class is for Modernizr. -->

<head>

	<meta charset="utf-8">
	
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>CAPTCP - PCAP Analyze Script</title>
	
	<meta name="title" content="PACTCP - A Python Based TCP Analyze Script">
	<meta name="description" content="PACTCP - A Python Based TCP Analyze Script">
	<!-- Google will often use this as its description of your page/site. Make it good. -->
	
	<meta name="google-site-verification" content="">
	<!-- Speaking of Google, don't forget to set your site up: http://google.com/webmasters -->
	
	<meta name="author" content="Hagen Paul Pfeifer">
	<meta name="Copyright" content="Copyright Hagen Paul Pfeifer 2010,2011. All Rights Reserved.">

	<!-- Dublin Core Metadata : http://dublincore.org/ -->
	<meta name="DC.title" content="PACTCP">
	<meta name="DC.subject" content="Python network analyze tool">
	<meta name="DC.creator" content="Hagen Paul Pfeifer">
	
	<link rel="shortcut icon" href="data/images/favicon.ico">
	<!-- This is the traditional favicon.
		 - size: 16x16 or 32x32
		 - transparency is OK
		 - see wikipedia for info on browser support: http://mky.be/favicon/ -->
		 
	<link rel="apple-touch-icon" href="data/images/apple-touch-icon.png">
	<!-- The is the icon for iOS's Web Clip.
		 - size: 57x57 for older iPhones, 72x72 for iPads, 114x114 for iPhone4's retina display (IMHO, just go ahead and use the biggest one)
		 - To prevent iOS from applying its styles to the icon name it thusly: apple-touch-icon-precomposed.png
		 - Transparency is not recommended (iOS will put a black BG behind the icon) -->
	
	<link rel="stylesheet" href="data/css/style.css">
	<script src="data/js/modernizr-1.7.min.js"></script>
<script type="text/javascript" src="http://use.typekit.com/nbn2flh.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

</head>
<body>


<div class="wrapper">
	<header>
		<h1><a href="/">CAPTCP</a></h1>
		<nav>
			<ol>
				<li><a href="#about">About</a></li>
				<li><a href="#modules">Modules</a></li>
				<li><a href="#installation">Installtion</a></li>
			</ol>
		</nav>
	</header>
	<article>
		<h1 id="about">About</h1>
		<p>
		Since several years I used to use a own repository of scripts to
		analyze network traffic. First I started with plain <a
			href="http://www.tcpdump.org/" data-twitter="tcpdump">tcpdump</a>,
		tcptrace, tcpslice, tcpstat and the other tools. After some years I
		started to wrote an own set of scripts, starting with Perl and later
		also some Ruby scripts. Before I forget, of course, a few C programs
		are also in the collection. Captcp is the attempt to rewrite the
		scripts in Python.
		</p>
		<h2>Some Word About Packet Analyzes</h2>

		<p>During the years some wisdoms are here collected. You can ignore
		them, sure, but eventually there are some tricks for you.</p>
		
		<figure>
		<img src="data/images/seq.png" alt="A before and after view of the file structure." />
		</figure> 

		<ul class="links">
			<li>Don't capture data life - capture the data via tcpdump and analyze the data off-line</li>
			<li>If you know what you want to analyze you can adjust tcpdump to capture the required data</li>
			<li>Make backups of your traces</li>
			<li>Don't use one tool, find the most useful tool for your requirements</li>
			<li>Last but not least: question the results!</li>
		</ul>

		<h1 id="modules">Modules</h1>

		<p>
		The script functionality is splitted into submodules. Similar to
		git, perf and kvm-tool. The following list provides an overview over
		the currently supported list. If in doubt you can call
		<code>captcp</code> without any argument to get the full list.
		</p>

		<p>
		<ul class="links">
			<li><strong>highlight</strong> - similar to tcpdump but with colorful highlighting and some other features</li>
			<li><strong>stats</strong> - print TCP flow statistics</li>
			<li><strong>geoip</strong> - for a given IP address the location is returned</li>
		</ul>
		</p>


		<h2>Highlight Module</h2>

		<p>
		The Highlight module is show a similar output compared to tcpdump.
		The difference is that streams are highlighted in different colors
		to distinguish between different flows.
		</p>

		<p>
		Another feature is to highlight the packet if something interesting
		in the packet is detected. The user is free to specify all kinds of
		packet characteristic. See option <code>match</code> to match a
		specific characteristic.
		</p>

		<h3>Options</h3>

		<pre>
		--match (-m) &lt;expression&gt;

			sport
			dport
			ackno
			seqno
			options.wsc
			options.mss
			options.sackblocks
			options.sackok
			time

		--verbose (-v)

		--suppress-other (-s)
			Suppress all other packets which do not match the match
			expression.

		--nocolor (-c)
		  This disables ANSI color sequences. This option is useful
			in combination with "--suppress-other" and Terminals where
			no ANSI color codes are available.

		</pre>

		<h3>Examples</h3>

		<p>Highlight packets with more then 2 SACK blocks</p>
		<div class="codebox">
			captcp highlight  --match "opts.sackblocks &gt; 2" trace.pcap
		</div>
		</p>

		<p>Highlight packets with source ip 192.168.1.1 (please note the
		quotation marks for an IP address):</p>
		<p>
		<div class="codebox">
			captcp highlight  --match 'ip.src == "192.168.1.1"' trace.pcap
		</div>
		</p>

		<p>Show only packets where the SYN and ACK packet is enabled. All
		other packets are NOT displayed (--suppress-other option):</p>
		<p>
		<div class="codebox">
			captcp highlight -s -m 'tcp.flags &amp; TH_ACK and tcp.flags &amp; TH_SYN' trace.pcap
		</div>
		</p>


		<h2>Stats Module</h2>

		<h2>GeoIP Module</h2>

		<p>
		Sometimes for larger analysis and network anomalies it is helpful to
		analyze from where a given packet is. What ISP, what counrty et
		cetera. To provide fast information about the location the
		<strong>geoip</strong> module can be used.
		</p>

		<h3>Note</h3>

		<p>
		This in an optional module. This module requires some third party
		software. Under Debian a simple aptitude install is sufficient:
		</p>

		<pre>
		aptitude install python-geoip
		</pre>

		<h3>Examples</h3>

		<p>Print the location for a given IP address</p>
		<div class="codebox">
			captcp geoip 78.120.0.1
		</div>
		</p>


		<h1 id="installation">Installation</h1>

		<p>
		There is no binary distribution of the python script. I decided to
		bundle the whole functionality in one Python script. So just grab
		the script an voila! ;)
		</p>

		<p>
		The lattest version can be downloaded from github via:
		</p>
		<p>
		<code>
			git clone git://github.com/hgn/captcp.git
		</code>
		</p>


	</article>
	<footer>
	<p>
	<small>
	&copy; Copyright Hagen Paul Pfeifer 2010, 2011. All Rights Reserved.
	</small>
	</p>
	</footer>
</div>


<!-- Grab Google CDN's jQuery. fall back to local if necessary -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script>window.jQuery || document.write("<script src='data/js/jquery-1.5.1.min.js'>\x3C/script>")</script>

<!-- this is where we put our custom functions -->
<script src="data/js/functions.js"></script>
</body>
</html>
